<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Send to kindle para Octopress</title>
  <meta name="description" content="En este blog encontraras cosas de iOS, Ruby on Rails, Padrino, reflexiones informáticas y hasta algo de bricolaje.
" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="canonical" href="http://javimoreno.es/blog/2013/03/22/send-to-kindle-para-octopress/">

  <link rel="shortcut icon" href="/assets/images/favicon.ico">
  <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href='http://fonts.googleapis.com/css?family=Sanchez:400italic,400' rel='stylesheet' type='text/css'>
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
	<link href="http://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">

  <link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
  <link rel="stylesheet" type="text/css" media="print" href="/css/print.css" />
	
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-38448478-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>
  <body itemscope itemtype="http://schema.org/Article">
	 <!-- header start -->

<!-- header end -->
    
    <main class="content" role="main">
      <article class="post">
        <div class="noarticleimage">
          <div class="post-meta">
					 
				  	<h1 class="post-title">Send to kindle para Octopress</h1>
				  	 
          </div>
        </div>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <section class="author">
              <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
              <h4>Javi</h4>
              <p class="bio"></p>
              <hr>
              <p class="published"><i class="fa fa-calendar"></i><time datetime="2013-03-22 00:35"> 22 de marzo de 2013</time></p>
              <p class="published"><i class="fa fa-clock-o"></i>  
              
              
              3 minutos
              
              de lectura
              </p>
            </section>
          </div>
        </div>
        <section class="post-content">
          <a name="topofpage"></a>
          <p>Cuando escribí la <a href="/blog/2013/03/08/como-mola-octopress/"><em>oda</em> a Octopress</a> comenté que me sentía más comodo con Ruby para tocar diversas partes del código del blog, como por ejemplo los plugins. En esta entrada voy a aprovechar la noticia del botón de <a href="http://www.genbeta.com/web/amazon-lanza-su-boton-para-enviar-contenido-al-kindle-desde-un-sitio-web">enviar a kindle</a> para que veáis lo fácil que es hacer un plugin.</p>

<!--more-->

<p>En primer lugar, vamos a ir a la página de Amazon donde <a href="http://www.amazon.com/gp/sendtokindle/developers/button">configuramos el botón</a> a nuestro gusto y generamos el widget. Según esta página, tendríamos que seguir dos sencillos pasos para poner el botón en nuestra web: </p>

<ol>
<li>Insertar un script antes del cierre de la etiqueta <em>body</em>.</li>
<li>Insertar un trozo de HTML en el lugar donde queremos que aparezca el botón.</li>
</ol>

<p>Lo que nosotros queremos es que el botón aparezca al final de nuestras entradas, junto con los botones de Karmacracy, Twitter, Facebook y Google+. En primer lugar, crearemos una variable <em>send<em>to</em>kindle</em> en el fichero _config.yml.</p>

<figure class="highlight"><pre><code class="language-yml" data-lang="yml"><span class="c1"># Send To Kindle Button</span>
<span class="s">send_to_kindle</span><span class="pi">:</span> <span class="s">true</span></code></pre></figure>

<p>De esta forma, podremos elegir poner o no el botón en nuestro blog.</p>

<p>Octopress viene de serie con opciones para compartir en Twitter, Facebook, Google+, etc. El fichero donde están recogidas las diferentes opciones se llama <em>sharing.html</em> y se encuentra en source/_includes/post/sharing.html. En este fichero es donde insertaremos el fragmento HTML del paso 2:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">{ % if site.send_to_kindle %}
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"kindleWidget"</span> <span class="na">style=</span><span class="s">"display:inline-block;padding:3px;cursor:pointer;font-size:11px;font-family:Arial;border-radius:3px;border:#ccc thin solid;color:black;background:transparent url('https://d1xnn692s7u6t6.cloudfront.net/button-gradient.png') repeat-x;background-size:contain;"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">style=</span><span class="s">"vertical-align:middle;"</span> <span class="na">src=</span><span class="s">"https://d1xnn692s7u6t6.cloudfront.net/black-15.png"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">style=</span><span class="s">"vertical-align:middle;margin-left:3px;"</span><span class="nt">&gt;</span>Send to Kindle<span class="nt">&lt;/span&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
{ % endif %}</code></pre></figure>

<p>Creo que lo que está pasando aquí es fácil de entender: solo si la variable global <em>send<em>to</em>kindle</em> esta configurada como true, se inyectará el fragmento HTML.</p>

<blockquote>
<p>Una aclaración. El uso de variables, condiciones, etc en Jekyll se realiza encerrando los trozos de código entre llave-porcentaje y porcentaje-llave. En el snippet anterior he escrito { % para que pudierais verlo porque de lo contrario, al generar esta entrada Jekyll habría interpretado que estaba intentando evaluar alguna condición y no lo habría mostrado. Si lo váis a copiar y pegar, acordaros de quitar el espacio entre { y %.</p>
</blockquote>

<p>Bueno, ya solo nos falta incluir el script al final del body de nuestra página. Ahora vamos a ver lo bien organizado que está todo en Octopress: en la carpeta source/_includes hay un archivo que se llama <em>after_footer.html</em>. Cuando lo editamos vemos que contiene <em>includes</em> de ficheros llamados google_plus_one.html, twitter_sharing.html, etc. Estos ficheros están en la misma carpeta y al abrirlos podemos ver que contienen los scripts necesarios para los botónes de Google+, Twitter, etc. 
Vamos a crear un nuevo fichero en esta misma carpeta llamado send_to_kindle.html y en el incluiremos el script que nos indican en Amazon que hay que poner al final del body. Nuevamente, evaluaremos si la variable para incluir el botón está a true:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">{ % if site.send_to_kindle %}
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"https://d1xnn692s7u6t6.cloudfront.net/widget.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span><span class="p">(</span><span class="kd">function</span> <span class="nx">k</span><span class="p">(){</span><span class="nb">window</span><span class="p">.</span><span class="nx">$SendToKindle</span><span class="o">&amp;&amp;</span><span class="nb">window</span><span class="p">.</span><span class="nx">$SendToKindle</span><span class="p">.</span><span class="nx">Widget</span><span class="p">?</span><span class="nx">$SendToKindle</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">init</span><span class="p">({}):</span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="mi">500</span><span class="p">);})();</span><span class="nt">&lt;/script&gt;</span>
{ % endif %}</code></pre></figure>

<p>Y en el archivo <em>after_footer.html</em> incluiremos el nuevo html que acabamos de crear:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">{ % include send_to_kindle.html %}</code></pre></figure>

<p>Listo, si ahora generamos y previsualizamos nuestro blog podremos ver un botón al final de cada artículo para enviar el contenido al kindle.</p>

<p>Como véis, todo es muy intuitivo. Con un poco de sentido común y navegando por las carpetas del blog para ver como funcionan los plugins que vienen de serie podemos ir dejando Octopress a nuestro gusto.</p>

<p>Pd: No me gusta como queda el botón, sale más alto de lo que se previsualiza en el sitio de Amazón. Mis conocimientos de css, javascript y html son bastante limitados por lo que no estoy seguro de si es algo que podamos corregir o si por el contrario está así en el widget.js y no podemos hacer nada. Tampoco me gusta que el botón de Karmacracy salga en una linea aparte pero son esas cosas que no he conseguido arreglar. Si vosotros habéis conseguido dejarlo mejor... decidme como!!!! </p>

        </section>
        <footer class="post-footer">
          <section class="share">
            
              
                <a class="icon-twitter" href="http://twitter.com/share?text=Send+to+kindle+para+Octopress&amp;url=http://javimoreno.es/blog/2013/03/22/send-to-kindle-para-octopress/"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                </a>
              
            
              
            
              
                <a class="icon-facebook" href="//www.facebook.com/sharer.php?t=Send+to+kindle+para+Octopress&amp;u=http://javimoreno.es/blog/2013/03/22/send-to-kindle-para-octopress/"
                  onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
                <i class="fa fa-facebook"></i><span class="hidden">facebook</span>
                </a>
              
            
              
                <a class="icon-linkedin" href="//www.linkedin.com/shareArticle?mini=true&title=Send+to+kindle+para+Octopress&amp;url=http://javimoreno.es/blog/2013/03/22/send-to-kindle-para-octopress/"
                  onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
                <i class="fa fa-linkedin"></i><span class="hidden">linkedin</span>
                </a>
              
            
          </section>
          <nav class="post-pagination-next" role="navigation">
            
              <a class="next" href="/blog/2013/03/25/variables-de-entorno-en-rails/">&larr; Variables de entorno en Rails</a>
            
          </nav>
          <nav class="post-pagination-previous" role="navigation">
            
              <a class="previous" href="/blog/2013/03/12/resacon-en-heroku/">Resacón en Heroku &rarr;</a>
            
          </nav>
          <nav class="post-pagination-clear" role="navigation">
          </nav>
		  
		  <comments class="post-comments">
		    <div id="disqus_thread"></div>
    <script type="text/javascript">
    var disqus_shortname = 'eloctoblog';
    
      
      // var disqus_developer = 1;
      var disqus_identifier = 'http://javimoreno.es/blog/2013/03/22/send-to-kindle-para-octopress/';
      var disqus_url = 'http://javimoreno.es/blog/2013/03/22/send-to-kindle-para-octopress/';
      var disqus_script = 'embed.js';
    
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		  </comments>
		  
        </footer>
      </article>
    </main>
        <div class="bottom-closer">
      <div class="background-closer-image"  style="background-image: url(/assets/images/cover-rails.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">Javi Moreno</h1>
        <h2 class="blog-description">En este blog encontraras cosas de iOS, Ruby on Rails, Padrino, reflexiones informáticas y hasta algo de bricolaje.
</h2>
        <a href="/" class="btn">Ir a la página principal</a>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/assets/js/index.js"></script>
<script type="text/javascript" src="/assets/js/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    
      $window.on('scroll', function() {
        var top = $window.scrollTop();

        if (top < 0 || top > 1500) { return; }
        $image
          .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
          .css('opacity', 1-Math.max(top/700, 0));
      });
      $window.trigger('scroll');

      var height = $('.article-image').height();
      $('.post-content').css('padding-top', height + 'px');

      $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
         && location.hostname == this.hostname) {
          var target = $(this.hash);
          target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
          if (target.length) {
            $('html,body').animate({ scrollTop: target.offset().top }, 500);
            return false;
          }
        }
      });

  });
}(jQuery));
</script>


  </body>
</html>
